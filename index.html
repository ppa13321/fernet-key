<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Fernet Optimizer - Acceso Verificado</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        body { background: #0a0a0a; color: #00ffff; font-family: 'Segoe UI', sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .card { background: #111; padding: 2.5rem; border: 2px solid #00ffff; border-radius: 15px; text-align: center; width: 90%; max-width: 420px; }
        #bloqueo { display: block; color: #ff4444; }
        #contenido { display: none; }
        input { width: 100%; padding: 14px; margin: 20px 0; background: #1a1a1a; border: 1px solid #00ffff; color: white; border-radius: 5px; text-align: center; font-size: 1.2rem; }
        button { background: #00ffff; color: black; border: none; padding: 14px; font-weight: bold; cursor: pointer; border-radius: 5px; width: 100%; text-transform: uppercase; }
        .key-text { font-size: 1.8rem; letter-spacing: 3px; color: #00ff00; font-weight: bold; display: block; margin: 10px 0; }
    </style>
</head>
<body onload="verificarAcceso()">
    <div class="card">
        <div id="bloqueo">
            <h2>‚ö†Ô∏è ACCESO DENEGADO</h2>
            <p>Debes pasar por el link oficial (Cuty.io) para acceder a esta p√°gina.</p>
        </div>

        <div id="contenido">
            <h2>üîë GENERADOR DE KEY</h2>
            <p style="color: #aaa;">Ingresa tu TOKEN de 6 caracteres:</p>
            <input type="text" id="tokenInput" maxlength="6" placeholder="EJ: A1B2C3">
            <div id="errorMsg" style="color: #ff4444; display:none; margin-bottom:10px;"></div>
            <button onclick="generarKey()">GENERAR MI KEY</button>
            <div id="keyDisplay" style="display:none; margin-top:20px; border:2px dashed #00ff00; padding:10px;">
                <span id="keyValue" class="key-text"></span>
            </div>
        </div>
    </div>

    <script>
        const SECRETO_URL = "URL_PASSWORD_2026"; // Clave secreta para el link

        function verificarAcceso() {
            const params = new URLSearchParams(window.location.search);
            const passRecibida = params.get('auth');
            
            // Generamos la clave basada en la HORA ACTUAL (cambia cada hora)
            const horaActual = new Date().getHours();
            const passEsperada = CryptoJS.MD5(SECRETO_URL + horaActual).toString().substring(0, 8);

            if (passRecibida === passEsperada) {
                document.getElementById('bloqueo').style.display = 'none';
                document.getElementById('contenido').style.display = 'block';
            }
        }

        function generarKey() {
            const token = document.getElementById('tokenInput').value.trim().toUpperCase();
            const secretoProg = "FERNET_PRO_2026"; 
            
            if (token.length !== 6) return;

            // Validaci√≥n de firma del Token (lo que hicimos antes)
            const hashBase = token.substring(0, 4);
            const firmaRecibida = token.substring(4, 6);
            const firmaEsperada = CryptoJS.MD5(hashBase + secretoProg).toString().toUpperCase().substring(0, 2);

            if (firmaRecibida === firmaEsperada) {
                const hashKey = CryptoJS.SHA256(token + secretoProg).toString().toUpperCase();
                document.getElementById('keyValue').innerText = hashKey.substring(0, 8);
                document.getElementById('keyDisplay').style.display = 'block';
            } else {
                alert("Token Inv√°lido");
            }
        }
    </script>
</body>
</html>
